{"ast":null,"code":"\"use strict\";\n\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst bind_decorator_1 = __importDefault(require(\"bind-decorator\"));\nconst crypto_1 = __importDefault(require(\"crypto\"));\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst url_1 = __importDefault(require(\"url\"));\nconst LinkFlow_1 = require(\"../components/LinkFlow\");\nconst Snackbar_1 = require(\"../components/Snackbar\");\nconst WalletLinkConnection_1 = require(\"../connection/WalletLinkConnection\");\nconst ScopedLocalStorage_1 = require(\"../lib/ScopedLocalStorage\");\nconst util_1 = require(\"../util\");\nconst aes256gcm = __importStar(require(\"./aes256gcm\"));\nconst Session_1 = require(\"./Session\");\nconst Web3Method_1 = require(\"./Web3Method\");\nconst Web3RequestCanceledMessage_1 = require(\"./Web3RequestCanceledMessage\");\nconst Web3RequestMessage_1 = require(\"./Web3RequestMessage\");\nconst Web3Response_1 = require(\"./Web3Response\");\nconst Web3ResponseMessage_1 = require(\"./Web3ResponseMessage\");\nclass WalletLinkRelay {\n  constructor(options) {\n    this.appName = \"\";\n    this.appLogoUrl = null;\n    this.attached = false;\n    this.walletLinkUrl = options.walletLinkUrl;\n    const u = url_1.default.parse(this.walletLinkUrl);\n    this.walletLinkOrigin = \"\".concat(u.protocol, \"//\").concat(u.host);\n    this.storage = new ScopedLocalStorage_1.ScopedLocalStorage(\"-walletlink:\".concat(this.walletLinkOrigin));\n    this.session = Session_1.Session.load(this.storage) || new Session_1.Session(this.storage).save();\n    this.connection = new WalletLinkConnection_1.WalletLinkConnection(this.session.id, this.session.key, this.walletLinkUrl);\n    this.connection.incomingEvent$.pipe(operators_1.filter(m => m.event === \"Web3Response\")).subscribe({\n      next: this.handleIncomingEvent\n    });\n    // if session is marked destroyed, reset and reload\n    this.connection.sessionConfig$.pipe(operators_1.filter(c => !!c.metadata && c.metadata.__destroyed === \"1\")).subscribe({\n      next: this.resetAndReload\n    });\n    this.snackbar = new Snackbar_1.Snackbar({\n      darkMode: options.darkMode\n    });\n    this.linkFlow = new LinkFlow_1.LinkFlow({\n      darkMode: options.darkMode,\n      version: options.version,\n      sessionId: this.session.id,\n      sessionSecret: this.session.secret,\n      walletLinkUrl: this.walletLinkUrl,\n      connected$: this.connection.connected$\n    });\n    this.connection.connect();\n  }\n  resetAndReload() {\n    this.connection.setSessionMetadata(\"__destroyed\", \"1\").pipe(operators_1.timeout(1000), operators_1.catchError(_ => rxjs_1.of(null))).subscribe(_ => {\n      this.connection.destroy();\n      this.storage.clear();\n      document.location.reload();\n    });\n  }\n  setAppInfo(appName, appLogoUrl) {\n    this.appName = appName;\n    this.appLogoUrl = appLogoUrl;\n  }\n  attach(el) {\n    if (this.attached) {\n      throw new Error(\"WalletLinkRelay is already attached\");\n    }\n    const container = document.createElement(\"div\");\n    container.className = \"-walletlink-css-reset\";\n    el.appendChild(container);\n    this.linkFlow.attach(container);\n    this.snackbar.attach(container);\n  }\n  getStorageItem(key) {\n    return this.storage.getItem(key);\n  }\n  setStorageItem(key, value) {\n    this.storage.setItem(key, value);\n  }\n  requestEthereumAccounts() {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.requestEthereumAccounts,\n      params: {\n        appName: this.appName,\n        appLogoUrl: this.appLogoUrl || null\n      }\n    });\n  }\n  signEthereumMessage(message, address, addPrefix, typedDataJson) {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.signEthereumMessage,\n      params: {\n        message: util_1.hexStringFromBuffer(message, true),\n        address,\n        addPrefix,\n        typedDataJson: typedDataJson || null\n      }\n    });\n  }\n  ethereumAddressFromSignedMessage(message, signature, addPrefix) {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.ethereumAddressFromSignedMessage,\n      params: {\n        message: util_1.hexStringFromBuffer(message, true),\n        signature: util_1.hexStringFromBuffer(signature, true),\n        addPrefix\n      }\n    });\n  }\n  signEthereumTransaction(params) {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.signEthereumTransaction,\n      params: {\n        fromAddress: params.fromAddress,\n        toAddress: params.toAddress,\n        weiValue: util_1.bigIntStringFromBN(params.weiValue),\n        data: util_1.hexStringFromBuffer(params.data, true),\n        nonce: params.nonce,\n        gasPriceInWei: params.gasPriceInWei ? util_1.bigIntStringFromBN(params.gasPriceInWei) : null,\n        gasLimit: params.gasLimit ? util_1.bigIntStringFromBN(params.gasLimit) : null,\n        chainId: params.chainId,\n        shouldSubmit: false\n      }\n    });\n  }\n  signAndSubmitEthereumTransaction(params) {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.signEthereumTransaction,\n      params: {\n        fromAddress: params.fromAddress,\n        toAddress: params.toAddress,\n        weiValue: util_1.bigIntStringFromBN(params.weiValue),\n        data: util_1.hexStringFromBuffer(params.data, true),\n        nonce: params.nonce,\n        gasPriceInWei: params.gasPriceInWei ? util_1.bigIntStringFromBN(params.gasPriceInWei) : null,\n        gasLimit: params.gasLimit ? util_1.bigIntStringFromBN(params.gasLimit) : null,\n        chainId: params.chainId,\n        shouldSubmit: true\n      }\n    });\n  }\n  submitEthereumTransaction(signedTransaction, chainId) {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.submitEthereumTransaction,\n      params: {\n        signedTransaction: util_1.hexStringFromBuffer(signedTransaction, true),\n        chainId\n      }\n    });\n  }\n  scanQRCode(regExp) {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.scanQRCode,\n      params: {\n        regExp\n      }\n    });\n  }\n  arbitraryRequest(data) {\n    return this.sendRequest({\n      method: Web3Method_1.Web3Method.arbitrary,\n      params: {\n        data\n      }\n    });\n  }\n  sendRequest(request) {\n    return new Promise((resolve, reject) => {\n      let hideSnackbarItem = null;\n      const id = crypto_1.default.randomBytes(8).toString(\"hex\");\n      const isRequestAccounts = request.method === Web3Method_1.Web3Method.requestEthereumAccounts;\n      const cancel = () => {\n        this.publishWeb3RequestCanceledEvent(id);\n        this.handleWeb3ResponseMessage(Web3ResponseMessage_1.Web3ResponseMessage({\n          id,\n          response: Web3Response_1.ErrorResponse(request.method, \"User rejected request\")\n        }));\n        hideSnackbarItem === null || hideSnackbarItem === void 0 ? void 0 : hideSnackbarItem();\n      };\n      if (isRequestAccounts) {\n        this.linkFlow.open({\n          onCancel: cancel\n        });\n        WalletLinkRelay.accountRequestCallbackIds.add(id);\n      } else {\n        const snackbarProps = {\n          message: \"Pushed a request to your wallet...\",\n          showProgressBar: true,\n          actions: [{\n            info: \"Made a mistake?\",\n            buttonLabel: \"Cancel\",\n            onClick: cancel\n          }, {\n            info: \"Not receiving requests?\",\n            buttonLabel: \"Reset Connection\",\n            onClick: this.resetAndReload\n          }]\n        };\n        hideSnackbarItem = this.snackbar.presentItem(snackbarProps);\n      }\n      WalletLinkRelay.callbacks.set(id, response => {\n        this.linkFlow.close();\n        hideSnackbarItem === null || hideSnackbarItem === void 0 ? void 0 : hideSnackbarItem();\n        if (response.errorMessage) {\n          return reject(new Error(response.errorMessage));\n        }\n        resolve(response);\n      });\n      this.publishWeb3RequestEvent(id, request);\n    });\n  }\n  publishWeb3RequestEvent(id, request) {\n    const message = Web3RequestMessage_1.Web3RequestMessage({\n      id,\n      request\n    });\n    this.publishEvent(\"Web3Request\", message, true).subscribe({\n      error: err => {\n        this.handleWeb3ResponseMessage(Web3ResponseMessage_1.Web3ResponseMessage({\n          id: message.id,\n          response: {\n            method: message.request.method,\n            errorMessage: err.message\n          }\n        }));\n      }\n    });\n  }\n  publishWeb3RequestCanceledEvent(id) {\n    const message = Web3RequestCanceledMessage_1.Web3RequestCanceledMessage(id);\n    this.publishEvent(\"Web3RequestCanceled\", message, false).subscribe();\n  }\n  publishEvent(event, message, callWebhook) {\n    const encrypted = aes256gcm.encrypt(JSON.stringify(Object.assign(Object.assign({}, message), {\n      origin: location.origin\n    })), this.session.secret);\n    return this.connection.publishEvent(event, encrypted, callWebhook);\n  }\n  handleIncomingEvent(event) {\n    let json;\n    try {\n      json = JSON.parse(aes256gcm.decrypt(event.data, this.session.secret));\n    } catch (_a) {\n      return;\n    }\n    const message = Web3ResponseMessage_1.isWeb3ResponseMessage(json) ? json : null;\n    if (!message) {\n      return;\n    }\n    this.handleWeb3ResponseMessage(message);\n  }\n  handleWeb3ResponseMessage(message) {\n    const {\n      response\n    } = message;\n    if (Web3Response_1.isRequestEthereumAccountsResponse(response)) {\n      Array.from(WalletLinkRelay.accountRequestCallbackIds.values()).forEach(id => this.invokeCallback(Object.assign(Object.assign({}, message), {\n        id\n      })));\n      WalletLinkRelay.accountRequestCallbackIds.clear();\n      return;\n    }\n    this.invokeCallback(message);\n  }\n  invokeCallback(message) {\n    const callback = WalletLinkRelay.callbacks.get(message.id);\n    if (callback) {\n      callback(message.response);\n      WalletLinkRelay.callbacks.delete(message.id);\n    }\n  }\n}\nWalletLinkRelay.callbacks = new Map();\nWalletLinkRelay.accountRequestCallbackIds = new Set();\n__decorate([bind_decorator_1.default], WalletLinkRelay.prototype, \"resetAndReload\", null);\n__decorate([bind_decorator_1.default], WalletLinkRelay.prototype, \"handleIncomingEvent\", null);\nexports.WalletLinkRelay = WalletLinkRelay;","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__importDefault","mod","__esModule","__importStar","result","k","hasOwnProperty","call","exports","value","bind_decorator_1","require","crypto_1","rxjs_1","operators_1","url_1","LinkFlow_1","Snackbar_1","WalletLinkConnection_1","ScopedLocalStorage_1","util_1","aes256gcm","Session_1","Web3Method_1","Web3RequestCanceledMessage_1","Web3RequestMessage_1","Web3Response_1","Web3ResponseMessage_1","WalletLinkRelay","constructor","options","appName","appLogoUrl","attached","walletLinkUrl","u","default","parse","walletLinkOrigin","concat","protocol","host","storage","ScopedLocalStorage","session","Session","load","save","connection","WalletLinkConnection","id","incomingEvent$","pipe","filter","m","event","subscribe","next","handleIncomingEvent","sessionConfig$","metadata","__destroyed","resetAndReload","snackbar","Snackbar","darkMode","linkFlow","LinkFlow","version","sessionId","sessionSecret","secret","connected$","connect","setSessionMetadata","timeout","catchError","_","of","destroy","clear","document","location","reload","setAppInfo","attach","el","Error","container","createElement","className","appendChild","getStorageItem","getItem","setStorageItem","setItem","requestEthereumAccounts","sendRequest","method","Web3Method","params","signEthereumMessage","message","address","addPrefix","typedDataJson","hexStringFromBuffer","ethereumAddressFromSignedMessage","signature","signEthereumTransaction","fromAddress","toAddress","weiValue","bigIntStringFromBN","data","nonce","gasPriceInWei","gasLimit","chainId","shouldSubmit","signAndSubmitEthereumTransaction","submitEthereumTransaction","signedTransaction","scanQRCode","regExp","arbitraryRequest","arbitrary","request","Promise","resolve","reject","hideSnackbarItem","randomBytes","toString","isRequestAccounts","cancel","publishWeb3RequestCanceledEvent","handleWeb3ResponseMessage","Web3ResponseMessage","response","ErrorResponse","open","onCancel","accountRequestCallbackIds","add","snackbarProps","showProgressBar","actions","info","buttonLabel","onClick","presentItem","callbacks","set","close","errorMessage","publishWeb3RequestEvent","Web3RequestMessage","publishEvent","error","err","Web3RequestCanceledMessage","callWebhook","encrypted","encrypt","JSON","stringify","assign","origin","json","decrypt","_a","isWeb3ResponseMessage","isRequestEthereumAccountsResponse","Array","from","values","forEach","invokeCallback","callback","get","delete","Map","Set","prototype"],"sources":["/Users/synallage/Desktop/fomoswap-uni/interface-73580de922ce3ff642430d71aa24f5c053e6dd4d/node_modules/walletlink/dist/relay/WalletLinkRelay.js"],"sourcesContent":["\"use strict\";\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst bind_decorator_1 = __importDefault(require(\"bind-decorator\"));\nconst crypto_1 = __importDefault(require(\"crypto\"));\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst url_1 = __importDefault(require(\"url\"));\nconst LinkFlow_1 = require(\"../components/LinkFlow\");\nconst Snackbar_1 = require(\"../components/Snackbar\");\nconst WalletLinkConnection_1 = require(\"../connection/WalletLinkConnection\");\nconst ScopedLocalStorage_1 = require(\"../lib/ScopedLocalStorage\");\nconst util_1 = require(\"../util\");\nconst aes256gcm = __importStar(require(\"./aes256gcm\"));\nconst Session_1 = require(\"./Session\");\nconst Web3Method_1 = require(\"./Web3Method\");\nconst Web3RequestCanceledMessage_1 = require(\"./Web3RequestCanceledMessage\");\nconst Web3RequestMessage_1 = require(\"./Web3RequestMessage\");\nconst Web3Response_1 = require(\"./Web3Response\");\nconst Web3ResponseMessage_1 = require(\"./Web3ResponseMessage\");\nclass WalletLinkRelay {\n    constructor(options) {\n        this.appName = \"\";\n        this.appLogoUrl = null;\n        this.attached = false;\n        this.walletLinkUrl = options.walletLinkUrl;\n        const u = url_1.default.parse(this.walletLinkUrl);\n        this.walletLinkOrigin = `${u.protocol}//${u.host}`;\n        this.storage = new ScopedLocalStorage_1.ScopedLocalStorage(`-walletlink:${this.walletLinkOrigin}`);\n        this.session =\n            Session_1.Session.load(this.storage) || new Session_1.Session(this.storage).save();\n        this.connection = new WalletLinkConnection_1.WalletLinkConnection(this.session.id, this.session.key, this.walletLinkUrl);\n        this.connection.incomingEvent$\n            .pipe(operators_1.filter(m => m.event === \"Web3Response\"))\n            .subscribe({ next: this.handleIncomingEvent });\n        // if session is marked destroyed, reset and reload\n        this.connection.sessionConfig$\n            .pipe(operators_1.filter(c => !!c.metadata && c.metadata.__destroyed === \"1\"))\n            .subscribe({ next: this.resetAndReload });\n        this.snackbar = new Snackbar_1.Snackbar({\n            darkMode: options.darkMode\n        });\n        this.linkFlow = new LinkFlow_1.LinkFlow({\n            darkMode: options.darkMode,\n            version: options.version,\n            sessionId: this.session.id,\n            sessionSecret: this.session.secret,\n            walletLinkUrl: this.walletLinkUrl,\n            connected$: this.connection.connected$\n        });\n        this.connection.connect();\n    }\n    resetAndReload() {\n        this.connection\n            .setSessionMetadata(\"__destroyed\", \"1\")\n            .pipe(operators_1.timeout(1000), operators_1.catchError(_ => rxjs_1.of(null)))\n            .subscribe(_ => {\n            this.connection.destroy();\n            this.storage.clear();\n            document.location.reload();\n        });\n    }\n    setAppInfo(appName, appLogoUrl) {\n        this.appName = appName;\n        this.appLogoUrl = appLogoUrl;\n    }\n    attach(el) {\n        if (this.attached) {\n            throw new Error(\"WalletLinkRelay is already attached\");\n        }\n        const container = document.createElement(\"div\");\n        container.className = \"-walletlink-css-reset\";\n        el.appendChild(container);\n        this.linkFlow.attach(container);\n        this.snackbar.attach(container);\n    }\n    getStorageItem(key) {\n        return this.storage.getItem(key);\n    }\n    setStorageItem(key, value) {\n        this.storage.setItem(key, value);\n    }\n    requestEthereumAccounts() {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.requestEthereumAccounts,\n            params: {\n                appName: this.appName,\n                appLogoUrl: this.appLogoUrl || null\n            }\n        });\n    }\n    signEthereumMessage(message, address, addPrefix, typedDataJson) {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.signEthereumMessage,\n            params: {\n                message: util_1.hexStringFromBuffer(message, true),\n                address,\n                addPrefix,\n                typedDataJson: typedDataJson || null\n            }\n        });\n    }\n    ethereumAddressFromSignedMessage(message, signature, addPrefix) {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.ethereumAddressFromSignedMessage,\n            params: {\n                message: util_1.hexStringFromBuffer(message, true),\n                signature: util_1.hexStringFromBuffer(signature, true),\n                addPrefix\n            }\n        });\n    }\n    signEthereumTransaction(params) {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.signEthereumTransaction,\n            params: {\n                fromAddress: params.fromAddress,\n                toAddress: params.toAddress,\n                weiValue: util_1.bigIntStringFromBN(params.weiValue),\n                data: util_1.hexStringFromBuffer(params.data, true),\n                nonce: params.nonce,\n                gasPriceInWei: params.gasPriceInWei\n                    ? util_1.bigIntStringFromBN(params.gasPriceInWei)\n                    : null,\n                gasLimit: params.gasLimit ? util_1.bigIntStringFromBN(params.gasLimit) : null,\n                chainId: params.chainId,\n                shouldSubmit: false\n            }\n        });\n    }\n    signAndSubmitEthereumTransaction(params) {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.signEthereumTransaction,\n            params: {\n                fromAddress: params.fromAddress,\n                toAddress: params.toAddress,\n                weiValue: util_1.bigIntStringFromBN(params.weiValue),\n                data: util_1.hexStringFromBuffer(params.data, true),\n                nonce: params.nonce,\n                gasPriceInWei: params.gasPriceInWei\n                    ? util_1.bigIntStringFromBN(params.gasPriceInWei)\n                    : null,\n                gasLimit: params.gasLimit ? util_1.bigIntStringFromBN(params.gasLimit) : null,\n                chainId: params.chainId,\n                shouldSubmit: true\n            }\n        });\n    }\n    submitEthereumTransaction(signedTransaction, chainId) {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.submitEthereumTransaction,\n            params: {\n                signedTransaction: util_1.hexStringFromBuffer(signedTransaction, true),\n                chainId\n            }\n        });\n    }\n    scanQRCode(regExp) {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.scanQRCode,\n            params: { regExp }\n        });\n    }\n    arbitraryRequest(data) {\n        return this.sendRequest({\n            method: Web3Method_1.Web3Method.arbitrary,\n            params: { data }\n        });\n    }\n    sendRequest(request) {\n        return new Promise((resolve, reject) => {\n            let hideSnackbarItem = null;\n            const id = crypto_1.default.randomBytes(8).toString(\"hex\");\n            const isRequestAccounts = request.method === Web3Method_1.Web3Method.requestEthereumAccounts;\n            const cancel = () => {\n                this.publishWeb3RequestCanceledEvent(id);\n                this.handleWeb3ResponseMessage(Web3ResponseMessage_1.Web3ResponseMessage({\n                    id,\n                    response: Web3Response_1.ErrorResponse(request.method, \"User rejected request\")\n                }));\n                hideSnackbarItem === null || hideSnackbarItem === void 0 ? void 0 : hideSnackbarItem();\n            };\n            if (isRequestAccounts) {\n                this.linkFlow.open({ onCancel: cancel });\n                WalletLinkRelay.accountRequestCallbackIds.add(id);\n            }\n            else {\n                const snackbarProps = {\n                    message: \"Pushed a request to your wallet...\",\n                    showProgressBar: true,\n                    actions: [\n                        {\n                            info: \"Made a mistake?\",\n                            buttonLabel: \"Cancel\",\n                            onClick: cancel\n                        },\n                        {\n                            info: \"Not receiving requests?\",\n                            buttonLabel: \"Reset Connection\",\n                            onClick: this.resetAndReload\n                        }\n                    ]\n                };\n                hideSnackbarItem = this.snackbar.presentItem(snackbarProps);\n            }\n            WalletLinkRelay.callbacks.set(id, response => {\n                this.linkFlow.close();\n                hideSnackbarItem === null || hideSnackbarItem === void 0 ? void 0 : hideSnackbarItem();\n                if (response.errorMessage) {\n                    return reject(new Error(response.errorMessage));\n                }\n                resolve(response);\n            });\n            this.publishWeb3RequestEvent(id, request);\n        });\n    }\n    publishWeb3RequestEvent(id, request) {\n        const message = Web3RequestMessage_1.Web3RequestMessage({ id, request });\n        this.publishEvent(\"Web3Request\", message, true).subscribe({\n            error: err => {\n                this.handleWeb3ResponseMessage(Web3ResponseMessage_1.Web3ResponseMessage({\n                    id: message.id,\n                    response: {\n                        method: message.request.method,\n                        errorMessage: err.message\n                    }\n                }));\n            }\n        });\n    }\n    publishWeb3RequestCanceledEvent(id) {\n        const message = Web3RequestCanceledMessage_1.Web3RequestCanceledMessage(id);\n        this.publishEvent(\"Web3RequestCanceled\", message, false).subscribe();\n    }\n    publishEvent(event, message, callWebhook) {\n        const encrypted = aes256gcm.encrypt(JSON.stringify(Object.assign(Object.assign({}, message), { origin: location.origin })), this.session.secret);\n        return this.connection.publishEvent(event, encrypted, callWebhook);\n    }\n    handleIncomingEvent(event) {\n        let json;\n        try {\n            json = JSON.parse(aes256gcm.decrypt(event.data, this.session.secret));\n        }\n        catch (_a) {\n            return;\n        }\n        const message = Web3ResponseMessage_1.isWeb3ResponseMessage(json) ? json : null;\n        if (!message) {\n            return;\n        }\n        this.handleWeb3ResponseMessage(message);\n    }\n    handleWeb3ResponseMessage(message) {\n        const { response } = message;\n        if (Web3Response_1.isRequestEthereumAccountsResponse(response)) {\n            Array.from(WalletLinkRelay.accountRequestCallbackIds.values()).forEach(id => this.invokeCallback(Object.assign(Object.assign({}, message), { id })));\n            WalletLinkRelay.accountRequestCallbackIds.clear();\n            return;\n        }\n        this.invokeCallback(message);\n    }\n    invokeCallback(message) {\n        const callback = WalletLinkRelay.callbacks.get(message.id);\n        if (callback) {\n            callback(message.response);\n            WalletLinkRelay.callbacks.delete(message.id);\n        }\n    }\n}\nWalletLinkRelay.callbacks = new Map();\nWalletLinkRelay.accountRequestCallbackIds = new Set();\n__decorate([\n    bind_decorator_1.default\n], WalletLinkRelay.prototype, \"resetAndReload\", null);\n__decorate([\n    bind_decorator_1.default\n], WalletLinkRelay.prototype, \"handleIncomingEvent\", null);\nexports.WalletLinkRelay = WalletLinkRelay;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}